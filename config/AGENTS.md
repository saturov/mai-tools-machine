# AGENTS.md

## Purpose
Инструкции по конфигурации агента проекта. Этот файл фиксирует, где хранятся конфиги, какие поля в них используются и какие правила соблюдать при изменениях.

# Agent Config

## Location
- `config/agent.yaml` — основной файл конфигурации агента.
- Используется локальными скриптами и задачами, которые обращаются к провайдеру LLM через `base_url`.

## Fields
- `provider` — тип провайдера, пример: `openai_compatible`.
- `model` — идентификатор модели, пример: `GLM-4.5-Air`.
- `base_url` — базовый URL API провайдера, пример: `https://api.z.ai/api/coding/paas/v4`.
- `api_key` — ключ доступа, пример: строка токена.
- `timeout_seconds` — таймаут запроса в секундах, пример: `30`.
- `max_retries` — число повторов при ошибках, пример: `2`.

## Change Policy
- Меняй только нужные поля. Не трогай формат YAML.
- Любые изменения `api_key` или `base_url` должны быть согласованы с тем, кто владеет доступом.
- Не коммитить секреты и ключи. Если ключ меняется, хранить его локально/в секретах и не публиковать.

## Safety Notes
- Перед запуском сетевых операций убедись, что `base_url` корректен и относится к ожидаемому провайдеру.
- Если меняешь `model`, проверь совместимость с `provider`.

## Related Files
- `config/agent.yaml`

# Policy Config

## Location
- `config/policy.yaml` — основной файл политики.
- Политика используется при проверке плана и при запуске выполнения.

## Fields
- `allowed_capabilities` — список разрешённых capability. Примеры: `[]` (разрешить все, если список пустой), `youtube.download`, `drive.upload`.
- `denied_capabilities` — список явно запрещённых capability. Примеры: `[]`, `tg.scrape`.
- Если capability указана в `denied_capabilities`, она блокируется даже если есть в `allowed_capabilities`.
- `max_steps` — максимальное число шагов в плане, пример: `10`.
- `max_tool_retries` — число повторов для инструмента при ошибке, пример: `1`.
- `max_run_seconds` — таймаут выполнения workflow в секундах, пример: `600`.
- `max_llm_calls` — лимит обращений к LLM в рамках одного запроса, пример: `1`. Примечание: сейчас поле не применяется в коде и служит как задел на будущее.
- `require_idempotent_for_auto` — требовать idempotency=`safe` для авто-выполнения. Примеры: `false`, `true`.

## Change Policy
- `config/policy.yaml` хранит дефолтную политику и коммитится в репозиторий.
- Меняй лимиты и списки capability под нужды окружения, не правя код.

## Related Files
- `config/policy.yaml`
